apiVersion: batch.tensorstack.dev/v1beta1
kind: PyTorchTrainingJob
metadata:
  name: t2struct-ft-e1bs16lr5e5
spec:
  replicaSpecs:
    - type: worker
      replicas: 1
      restartPolicy: OnFailure
      template:
        spec:
          containers:
            - image: >-
                registry.ibmc.t9kcloud.cn/t9kpublic/jupyterlab-miniconda-24.7.1:20241031-sudo
              name: pytorch
              resources:
                requests:
                  cpu: '1'
                  memory: 4Gi
                  nvidia.com/gpu: '1'
                limits:
                  cpu: '2'
                  memory: 16Gi
                  nvidia.com/gpu: '1'
              args:
                - t2struct-ft.py
                - --epochs
                - "1"
                - --batch_size
                - "16"
                - --learning_rate
                - "5e-5"
                - --data_path
                - "data/Augmentationx10.jsonl"
                - --weights_path
                - "weights/Pinal/T2struc-1.2B"
              command:
                - /t9k/mnt/.conda/envs/amp/bin/python
              workingDir: /t9k/mnt/AMP-rebuilt/
              volumeMounts:
                - mountPath: /t9k/mnt
                  name: mntdir
          volumes:
            - name: mntdir
              persistentVolumeClaim:
                claimName: work
  # runMode:
  #   debug:
  #     enabled: false
  #     replicaSpecs: []
  # scheduler:
  #   t9kScheduler:
  #     priority: 0
  #     queue: a100
